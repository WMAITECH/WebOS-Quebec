<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test AI Orchestrator</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      max-width: 800px;
      width: 100%;
      padding: 32px;
    }

    h1 {
      color: #1e293b;
      margin-bottom: 8px;
      font-size: 28px;
    }

    .subtitle {
      color: #64748b;
      margin-bottom: 24px;
      font-size: 14px;
    }

    .status {
      background: #f1f5f9;
      border-radius: 8px;
      padding: 12px 16px;
      margin-bottom: 24px;
      font-size: 14px;
      color: #475569;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .status-indicator {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #10b981;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .chat-container {
      background: #f8fafc;
      border-radius: 12px;
      padding: 20px;
      height: 400px;
      overflow-y: auto;
      margin-bottom: 16px;
    }

    .message {
      margin-bottom: 16px;
      display: flex;
      gap: 12px;
    }

    .message.user {
      flex-direction: row-reverse;
    }

    .message-avatar {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      flex-shrink: 0;
    }

    .message.user .message-avatar {
      background: linear-gradient(135deg, #667eea, #764ba2);
    }

    .message.ai .message-avatar {
      background: linear-gradient(135deg, #3b82f6, #1e40af);
    }

    .message-content {
      background: white;
      padding: 12px 16px;
      border-radius: 12px;
      max-width: 70%;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .message.user .message-content {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
    }

    .input-container {
      display: flex;
      gap: 12px;
    }

    input {
      flex: 1;
      padding: 14px 16px;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      font-size: 15px;
      transition: border-color 0.2s;
    }

    input:focus {
      outline: none;
      border-color: #667eea;
    }

    button {
      padding: 14px 28px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
    }

    button:active {
      transform: translateY(0);
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .quick-actions {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 16px;
    }

    .quick-action {
      padding: 8px 16px;
      background: white;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 13px;
      color: #475569;
      cursor: pointer;
      transition: all 0.2s;
    }

    .quick-action:hover {
      border-color: #667eea;
      color: #667eea;
    }

    .tool-call-badge {
      display: inline-block;
      background: #eff6ff;
      color: #1e40af;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
      margin-top: 8px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ü§ñ Test AI Orchestrator</h1>
    <p class="subtitle">Interface de test pour l'agent orchestrateur central WebOS Qu√©bec</p>

    <div class="status">
      <div class="status-indicator"></div>
      <span id="statusText">Syst√®me pr√™t - En attente de commandes</span>
    </div>

    <div class="quick-actions">
      <div class="quick-action" onclick="sendQuickAction('Ouvre l\'application Mail')">üìß Ouvre Mail</div>
      <div class="quick-action" onclick="sendQuickAction('Liste mes fichiers')">üìÅ Liste fichiers</div>
      <div class="quick-action" onclick="sendQuickAction('Envoie une notification de test')">üîî Notification</div>
      <div class="quick-action" onclick="sendQuickAction('Ouvre l\'application Messages')">üí¨ Ouvre Messages</div>
    </div>

    <div class="chat-container" id="chatContainer">
      <div class="message ai">
        <div class="message-avatar">ü§ñ</div>
        <div class="message-content">
          Bonjour! Je suis l'agent orchestrateur de WebOS Qu√©bec. Je peux contr√¥ler le syst√®me via des tool-calls. Essayez de me demander d'ouvrir une application ou de lire des fichiers.
        </div>
      </div>
    </div>

    <div class="input-container">
      <input
        type="text"
        id="userInput"
        placeholder="Demandez-moi d'ouvrir Mail, de lister les fichiers, etc."
        onkeypress="if(event.key==='Enter') sendMessage()"
      />
      <button onclick="sendMessage()" id="sendBtn">Envoyer</button>
    </div>
  </div>

  <script>
    // Simuler l'orchestrateur pour d√©monstration
    function addMessage(content, isUser = false, toolCall = null) {
      const chat = document.getElementById('chatContainer');
      const msg = document.createElement('div');
      msg.className = `message ${isUser ? 'user' : 'ai'}`;

      const avatar = document.createElement('div');
      avatar.className = 'message-avatar';
      avatar.textContent = isUser ? 'üë§' : 'ü§ñ';

      const msgContent = document.createElement('div');
      msgContent.className = 'message-content';
      msgContent.innerHTML = content;

      if (toolCall) {
        const badge = document.createElement('div');
        badge.className = 'tool-call-badge';
        badge.textContent = `üîß ${toolCall}`;
        msgContent.appendChild(badge);
      }

      msg.appendChild(avatar);
      msg.appendChild(msgContent);
      chat.appendChild(msg);
      chat.scrollTop = chat.scrollHeight;
    }

    function setStatus(text, isLoading = false) {
      const status = document.getElementById('statusText');
      status.textContent = text;
    }

    async function sendMessage() {
      const input = document.getElementById('userInput');
      const btn = document.getElementById('sendBtn');
      const message = input.value.trim();

      if (!message) return;

      addMessage(message, true);
      input.value = '';
      btn.disabled = true;
      setStatus('L\'IA traite votre demande...', true);

      // Simuler l'analyse de l'IA
      await new Promise(resolve => setTimeout(resolve, 1000));

      // D√©tecter l'intention
      const lowerMsg = message.toLowerCase();

      if (lowerMsg.includes('ouvre') && lowerMsg.includes('mail')) {
        addMessage(
          `Je comprends que vous voulez ouvrir l'application Mail. Je vais g√©n√©rer un tool-call pour ouvrir cette application.`,
          false
        );

        await new Promise(resolve => setTimeout(resolve, 500));

        // Simuler le tool-call
        addMessage(
          `<strong>Tool-Call g√©n√©r√©:</strong><br>
          <code>{"tool": "ui_control", "action": "open_app", "params": {"appName": "mail"}}</code><br><br>
          ‚è≥ En attente de votre permission...`,
          false,
          'ui_control.open_app'
        );

        await new Promise(resolve => setTimeout(resolve, 1500));

        addMessage(
          `‚úÖ L'application Mail a √©t√© ouverte avec succ√®s! Vous devriez maintenant voir l'interface de messagerie.`,
          false
        );

      } else if (lowerMsg.includes('liste') && lowerMsg.includes('fichier')) {
        addMessage(
          `Je vais lister les fichiers du syst√®me via le service de fichiers.`,
          false
        );

        await new Promise(resolve => setTimeout(resolve, 500));

        addMessage(
          `<strong>Tool-Call g√©n√©r√©:</strong><br>
          <code>{"tool": "file_service", "action": "list", "params": {}}</code><br><br>
          ‚è≥ En attente de votre permission...`,
          false,
          'file_service.list'
        );

        await new Promise(resolve => setTimeout(resolve, 1500));

        addMessage(
          `‚úÖ Fichiers trouv√©s:<br>
          üìÑ document.txt (1.2 KB)<br>
          üìä data.json (5.6 KB)<br>
          üìÅ images/ (dossier)`,
          false
        );

      } else if (lowerMsg.includes('notification')) {
        addMessage(
          `Je vais envoyer une notification de test.`,
          false
        );

        await new Promise(resolve => setTimeout(resolve, 500));

        addMessage(
          `<strong>Tool-Call g√©n√©r√©:</strong><br>
          <code>{"tool": "notification_service", "action": "send", "params": {"title": "Test", "message": "Notification envoy√©e par l'IA"}}</code><br><br>
          ‚è≥ En attente de votre permission...`,
          false,
          'notification_service.send'
        );

        await new Promise(resolve => setTimeout(resolve, 1500));

        addMessage(
          `‚úÖ Notification envoy√©e avec succ√®s!`,
          false
        );

      } else if (lowerMsg.includes('ouvre') && lowerMsg.includes('message')) {
        addMessage(
          `Je vais ouvrir l'application Messages.`,
          false
        );

        await new Promise(resolve => setTimeout(resolve, 500));

        addMessage(
          `<strong>Tool-Call g√©n√©r√©:</strong><br>
          <code>{"tool": "ui_control", "action": "open_app", "params": {"appName": "messages"}}</code><br><br>
          ‚è≥ En attente de votre permission...`,
          false,
          'ui_control.open_app'
        );

        await new Promise(resolve => setTimeout(resolve, 1500));

        addMessage(
          `‚úÖ L'application Messages a √©t√© ouverte avec succ√®s!`,
          false
        );

      } else {
        addMessage(
          `Je peux vous aider avec les actions suivantes:<br><br>
          üîπ Ouvrir des applications (Mail, Messages, etc.)<br>
          üîπ Lister et g√©rer les fichiers<br>
          üîπ Envoyer des notifications<br>
          üîπ Lire les conversations<br><br>
          Essayez: "Ouvre Mail" ou "Liste mes fichiers"`,
          false
        );
      }

      btn.disabled = false;
      setStatus('Syst√®me pr√™t - En attente de commandes');
    }

    function sendQuickAction(action) {
      document.getElementById('userInput').value = action;
      sendMessage();
    }

    // Message de bienvenue
    console.log('ü§ñ AI Orchestrator Test Interface Ready');
    console.log('Cette interface simule le comportement du syst√®me d\'orchestration');
    console.log('Pour utiliser le vrai syst√®me, ouvrez /public/WOSQ.v4.wm.html');
  </script>
</body>
</html>
